{% extends "base.html" %}

{% block title %}Agregar Producto{% endblock %}

{% block content %}
<div class="card shadow-lg mx-auto" style="max-width: 600px;">
    <div class="card-header text-white" style="background-color: #00bcd4;">
        <h4 class="mb-0">➕ Agregar Nuevo Producto</h4>
    </div>
    <div class="card-body">
        {% if error %}
        <div class="alert alert-danger" role="alert">{{ error }}</div>
        {% endif %}
        
        <form method="post" action="{% url 'agregar_producto' %}">
            {% csrf_token %}
            <div class="mb-3">
                <label for="nombre_producto" class="form-label">Nombre del Producto</label>
                <input type="text" class="form-control" id="nombre_producto" name="nombre_producto" 
                       value="{{ form_data.nombre_producto|default:'' }}" required>
            </div>
            <div class="mb-3">
                <label for="sku" class="form-label">SKU/Código</label>
                <input type="text" class="form-control" id="sku" name="sku" 
                    value="{{ form_data.sku|default:'' }}" required>
            </div>
            <div class="mb-3">
                <label for="descripcion" class="form-label">Descripción</label>
                <textarea class="form-control" id="descripcion" name="descripcion" rows="3">{{ form_data.descripcion }}</textarea>
            </div>
            <div class="mb-3">
                <label for="precio" class="form-label">Precio ($)</label>
                <input type="number" step="0.01" class="form-control" id="precio" name="precio" 
                       value="{{ form_data.precio|default:'' }}" required>
            </div>
            <div class="mb-3">
                <label for="stock" class="form-label">Stock Inicial</label>
                <input type="number" class="form-control" id="stock" name="stock" 
                       value="{{ form_data.stock|default:'' }}" required>
            </div>
            <div class="mb-3">
                <label for="proveedor_id" class="form-label">Proveedor</label>
                <select class="form-select" id="proveedor_id" name="proveedor_id" required>
                    <option value="">Seleccione un proveedor...</option>
                    {% for p in proveedores %}
                        <option value="{{ p.id }}" 
                            {% if p.id|stringformat:"s" == form_data.proveedor_id|stringformat:"s" %}selected{% endif %}>
                            {{ p.nombre_empresa }} (ID: {{ p.id }})
                        </option>
                    {% empty %}
                        <option value="" disabled>No hay proveedores registrados. Por favor agregue uno primero.</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <label for="distribuidores" class="form-label">Distribuidores Asignados</label>
                <select class="form-select" id="distribuidores" name="distribuidores" multiple size="4">
                    {% for d in distribuidores %}
                        <option value="{{ d.id }}">
                            {{ d.nombre_distribuidor }} (Servicio: {{ d.tipo_servicio }})
                        </option>
                    {% endfor %}
                </select>
                <small class="form-text text-muted">Mantén presionada la tecla Ctrl/Cmd para seleccionar varios.</small>
            </div>
            
            <button type="submit" class="btn text-white w-100" style="background-color: #00bcd4;">Guardar Producto</button>
        </form>
    </div>
</div>
{% endblock %}